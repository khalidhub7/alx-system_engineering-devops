sudo ufw allow from "$replica_server" to any port 3306
sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf
# after change 'mysqld.cnf' file (primary)
sudo systemctl restart mysql
# after change 'mysqld.cnf' file (replica)
sudo systemctl restart mysql





-- Drop users if they already exist
DROP USER IF EXISTS 'holberton_user'@'52.91.134.33';
DROP USER IF EXISTS 'replica_user'@'%';
DROP USER IF EXISTS 'web02'@'52.91.134.33';
-- Create users with appropriate privileges
CREATE USER 'holberton_user'@'52.91.134.33' IDENTIFIED WITH mysql_native_password BY 'projectcorrection280hbtn';
GRANT REPLICATION CLIENT ON *.* TO 'holberton_user'@'52.91.134.33';
CREATE USER 'replica_user'@'%' IDENTIFIED BY '0000';
GRANT REPLICATION SLAVE ON *.* TO 'replica_user'@'%';
CREATE USER 'web02'@'52.91.134.33' IDENTIFIED BY 'web02';
GRANT REPLICATION SLAVE ON *.* TO 'web02'@'52.91.134.33';
-- Drop database if it already exists
DROP DATABASE IF EXISTS tyrell_corp;
-- Create database and table, then insert data
CREATE DATABASE tyrell_corp;
USE tyrell_corp;
CREATE TABLE nexus6 (id INT, name VARCHAR(255));
INSERT INTO nexus6 (id, name) VALUES (77, 'KHalid');
-- Grant select privileges on the table to holberton_user
GRANT SELECT ON tyrell_corp.nexus6 TO 'holberton_user'@'52.91.134.33';
-- Grant necessary privileges to holberton_user
GRANT SELECT ON mysql.user TO 'holberton_user'@'52.91.134.33';
-- Flush privileges to ensure all changes take effect
FLUSH PRIVILEGES;





CHANGE MASTER TO
    MASTER_HOST='100.27.2.194',
    MASTER_USER='replica_user',
    MASTER_PASSWORD='0000',
    MASTER_LOG_FILE='mysql-bin.000002',
    MASTER_LOG_POS=154;
START SLAVE;
